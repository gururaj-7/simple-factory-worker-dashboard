<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Factory Worker Dashboard</title>
  <style>
    /* ========== GLOBAL ========== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Poppins", sans-serif;
    }

    body {
      background: #f3f6fc;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      background: #007bff;
      color: white;
      text-align: center;
      padding: 20px;
      font-size: 26px;
      font-weight: 600;
      letter-spacing: 1px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
    }

    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 30px;
      padding: 25px 50px;
    }

    /* ========== ADD WORKER SECTION ========== */
    .add-section {
      background: white;
      border-radius: 14px;
      padding: 40px 50px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .add-section h2 {
      color: #007bff;
      margin-bottom: 25px;
      font-size: 24px;
    }

    form {
      display: flex;
      align-items: center;
      justify-content: center;
      flex-wrap: wrap;
      gap: 25px;
      width: 100%;
      max-width: 1100px;
    }

    .form-group {
      display: flex;
      align-items: center;
      gap: 10px;
      flex: 1;
      min-width: 280px;
    }

    label {
      font-weight: 600;
      color: #333;
      white-space: nowrap;
    }

    input {
      flex: 1;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 16px;
      transition: 0.3s;
    }

    input:focus {
      border-color: #007bff;
      box-shadow: 0 0 8px rgba(0, 123, 255, 0.2);
      outline: none;
    }

    .btn-container {
      width: 100%;
      display: flex;
      justify-content: center;
      margin-top: 25px;
    }

    button {
      background: #007bff;
      color: white;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      font-size: 16px;
      transition: 0.3s;
      padding: 12px 40px;
    }

    button:hover {
      background: #0056b3;
    }

    /* ========== WORKER TABLE SECTION ========== */
    .table-section {
      background: white;
      border-radius: 14px;
      padding: 30px 40px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .table-section h2 {
      color: #007bff;
      margin-bottom: 20px;
      font-size: 24px;
      text-align: center;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      border-radius: 10px;
      overflow: hidden;
    }

    th, td {
      padding: 14px;
      text-align: center;
      border-bottom: 1px solid #e6e6e6;
    }

    th {
      background: #007bff;
      color: white;
      font-weight: 600;
      font-size: 16px;
    }

    td {
      font-size: 15px;
      color: #333;
    }

    td button {
      background: #ff4d4d;
      border: none;
      color: white;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: 0.3s;
    }

    td button:hover {
      background: #d40000;
    }

    .no-data {
      text-align: center;
      color: #888;
      padding: 20px;
    }

    .total {
      margin-top: 20px;
      font-weight: 600;
      text-align: right;
      font-size: 18px;
      color: #333;
      background: #f9f9f9;
      padding: 12px;
      border-radius: 8px;
    }

    footer {
      text-align: center;
      padding: 15px;
      background: #007bff;
      color: white;
      font-size: 14px;
    }

    @media (max-width: 768px) {
      main {
        padding: 20px;
      }

      form {
        flex-direction: column;
        gap: 15px;
      }

      .form-group {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <header>üè≠ Factory Worker Management Dashboard</header>

  <main>
    <!-- ADD WORKER -->
    <section class="add-section">
      <h2>Add New Worker</h2>
      <form id="workerForm">
        <div class="form-group">
          <label for="name">Worker Name:</label>
          <input type="text" id="name" placeholder="Enter worker name" required />
        </div>

        <div class="form-group">
          <label for="salary">Daily Salary (‚Çπ):</label>
          <input type="number" id="salary" placeholder="Enter daily salary" required />
        </div>

        <div class="form-group">
          <label for="age">Age:</label>
          <input type="number" id="age" placeholder="Enter age" required />
        </div>

        <div class="btn-container">
          <button type="submit">‚ûï Add Worker</button>
        </div>
      </form>
    </section>

    <!-- WORKER LIST -->
    <section class="table-section">
      <h2>Worker List</h2>
      <table id="workerTable">
        <thead>
          <tr>
            <th>Name</th>
            <th>Salary (‚Çπ)</th>
            <th>Age</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="workerBody">
          <tr><td colspan="4" class="no-data">No workers added yet</td></tr>
        </tbody>
      </table>
      <div id="totalSalary" class="total">Total Daily Wages: ‚Çπ0</div>
    </section>
  </main>

  <footer>¬© 2025 Factory Management Dashboard</footer>

  <script>
  const form = document.getElementById('workerForm');
  const workerBody = document.getElementById('workerBody');
  const totalSalaryDiv = document.getElementById('totalSalary');

  async function fetchWorkers() {
    const res = await fetch('/api/workers');
    const workers = await res.json();
    displayWorkers(workers);
  }

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const name = document.getElementById('name').value.trim();
    const salary = parseFloat(document.getElementById('salary').value.trim());
    const age = parseInt(document.getElementById('age').value.trim());
    if (!name || !salary || !age) return;

    await fetch('/api/workers', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name, salary, age })
    });

    form.reset();
    fetchWorkers();
  });

  async function deleteWorker(id) {
    await fetch('/api/workers/' + id, { method: 'DELETE' });
    fetchWorkers();
  }

  function displayWorkers(workers) {
    workerBody.innerHTML = '';
    if (workers.length === 0) {
      workerBody.innerHTML = '<tr><td colspan="4" class="no-data">No workers added yet</td></tr>';
      totalSalaryDiv.textContent = "Total Daily Wages: ‚Çπ0";
      return;
    }

    let totalSalary = 0;
    workers.forEach(worker => {
      const salary = Number(worker.salary) || 0;
      totalSalary += salary;

      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${worker.name}</td>
        <td>‚Çπ${salary.toLocaleString()}</td>
        <td>${worker.age}</td>
        <td><button onclick="deleteWorker(${worker.id})">Delete</button></td>
      `;
      workerBody.appendChild(row);
    });

    totalSalaryDiv.textContent = `Total Daily Wages: ‚Çπ${totalSalary.toLocaleString()}`;
  }

  fetchWorkers();
  </script>
</body>
</html>
